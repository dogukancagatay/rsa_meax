<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>RSA Message Encryption and Authentication with X-509: lib/general_opts.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">RSA Message Encryption and Authentication with X-509
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">lib/general_opts.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>General operations for the program.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="sha256_8h_source.html">sha256.h</a>&quot;</code><br/>
</div>
<p><a href="general__opts_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a250f51f15a488f405157e57769d8ad0e"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="general__opts_8h.html#a250f51f15a488f405157e57769d8ad0e">create_hash_of_string</a> (char *str, int size)</td></tr>
<tr class="memdesc:a250f51f15a488f405157e57769d8ad0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hashes the given string value.  <a href="#a250f51f15a488f405157e57769d8ad0e"></a><br/></td></tr>
<tr class="memitem:af5291dd029356e9bb2946bd0bfa2d7a8"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="general__opts_8h.html#af5291dd029356e9bb2946bd0bfa2d7a8">create_hash_of_file</a> (char *filename)</td></tr>
<tr class="memdesc:af5291dd029356e9bb2946bd0bfa2d7a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hashes the given file.  <a href="#af5291dd029356e9bb2946bd0bfa2d7a8"></a><br/></td></tr>
<tr class="memitem:ac2a35e39b455ce1139aa1c8684301da1"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="general__opts_8h.html#ac2a35e39b455ce1139aa1c8684301da1">pub_enc</a> (char *m, <a class="el" href="struct_r_s_a___k_e_y.html">rsa_key</a> *key)</td></tr>
<tr class="memdesc:ac2a35e39b455ce1139aa1c8684301da1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts the given plain text with the given public key.  <a href="#ac2a35e39b455ce1139aa1c8684301da1"></a><br/></td></tr>
<tr class="memitem:a9203fddda70b31c6da977a33328941d1"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="general__opts_8h.html#a9203fddda70b31c6da977a33328941d1">pri_dec</a> (char *c, <a class="el" href="struct_r_s_a___k_e_y.html">rsa_key</a> *key)</td></tr>
<tr class="memdesc:a9203fddda70b31c6da977a33328941d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts the given ciphered text(encrypted with public encryption) with the given private key.  <a href="#a9203fddda70b31c6da977a33328941d1"></a><br/></td></tr>
<tr class="memitem:a5736affaf8dc8bc05558cee3f198f62e"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="general__opts_8h.html#a5736affaf8dc8bc05558cee3f198f62e">pub_dec</a> (char *c, <a class="el" href="struct_r_s_a___k_e_y.html">rsa_key</a> *key)</td></tr>
<tr class="memdesc:a5736affaf8dc8bc05558cee3f198f62e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts the given ciphered text(encrypted with private encryption) with the given public key.  <a href="#a5736affaf8dc8bc05558cee3f198f62e"></a><br/></td></tr>
<tr class="memitem:a360ad629958e9cc22babf446ed6550f3"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="general__opts_8h.html#a360ad629958e9cc22babf446ed6550f3">pri_enc</a> (char *m, <a class="el" href="struct_r_s_a___k_e_y.html">rsa_key</a> *key)</td></tr>
<tr class="memdesc:a360ad629958e9cc22babf446ed6550f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts the given plain text with the given private key.  <a href="#a360ad629958e9cc22babf446ed6550f3"></a><br/></td></tr>
<tr class="memitem:a2f2b3dc8a17b5aacaef9690409de89df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="general__opts_8h.html#a2f2b3dc8a17b5aacaef9690409de89df">write_public_key_to_file</a> (<a class="el" href="struct_r_s_a___k_e_y_s.html">rsa_keys</a> *keys, char *username)</td></tr>
<tr class="memdesc:a2f2b3dc8a17b5aacaef9690409de89df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes the public key to file with user name.  <a href="#a2f2b3dc8a17b5aacaef9690409de89df"></a><br/></td></tr>
<tr class="memitem:a118bb481605bbf6a2ad228f078369999"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="general__opts_8h.html#a118bb481605bbf6a2ad228f078369999">write_private_key_to_file</a> (<a class="el" href="struct_r_s_a___k_e_y_s.html">rsa_keys</a> *keys, char *username)</td></tr>
<tr class="memdesc:a118bb481605bbf6a2ad228f078369999"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes the private key to file with user name.  <a href="#a118bb481605bbf6a2ad228f078369999"></a><br/></td></tr>
<tr class="memitem:a438de4315ebdf2f27597aa7950a70184"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="general__opts_8h.html#a438de4315ebdf2f27597aa7950a70184">concatenate</a> (char *s1, char *s2)</td></tr>
<tr class="memitem:a20100a033cb2270b7e73bc8411fb5421"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="general__opts_8h.html#a20100a033cb2270b7e73bc8411fb5421">read_file_to_string</a> (char *filename)</td></tr>
<tr class="memdesc:a20100a033cb2270b7e73bc8411fb5421"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets file content.  <a href="#a20100a033cb2270b7e73bc8411fb5421"></a><br/></td></tr>
<tr class="memitem:ab2b15940f94a5725da201f7ccfc1f742"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="general__opts_8h.html#ab2b15940f94a5725da201f7ccfc1f742">write_string_to_file</a> (char *filename, char *str)</td></tr>
<tr class="memdesc:ab2b15940f94a5725da201f7ccfc1f742"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes the string to file.  <a href="#ab2b15940f94a5725da201f7ccfc1f742"></a><br/></td></tr>
<tr class="memitem:a7b5bcb0d1c99ef714c433413a254617f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_r_s_a___k_e_y.html">rsa_key</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="general__opts_8h.html#a7b5bcb0d1c99ef714c433413a254617f">get_key_from_file</a> (char *filename)</td></tr>
<tr class="memdesc:a7b5bcb0d1c99ef714c433413a254617f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the RSA key from file.  <a href="#a7b5bcb0d1c99ef714c433413a254617f"></a><br/></td></tr>
<tr class="memitem:a992f24eeea692289100bb7cb4c005422"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="general__opts_8h.html#a992f24eeea692289100bb7cb4c005422">create_ds</a> (char *id, <a class="el" href="struct_r_s_a___k_e_y.html">rsa_key</a> *pr_key)</td></tr>
<tr class="memdesc:a992f24eeea692289100bb7cb4c005422"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates the digital signature of the text.  <a href="#a992f24eeea692289100bb7cb4c005422"></a><br/></td></tr>
<tr class="memitem:aac69d038742dcc1a00a1311a9421b63d"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="general__opts_8h.html#aac69d038742dcc1a00a1311a9421b63d">extract_id</a> (char *msg)</td></tr>
<tr class="memdesc:aac69d038742dcc1a00a1311a9421b63d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Separates the plain text.  <a href="#aac69d038742dcc1a00a1311a9421b63d"></a><br/></td></tr>
<tr class="memitem:a24adcc1de92743dc8eaeebc54c40b568"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="general__opts_8h.html#a24adcc1de92743dc8eaeebc54c40b568">extract_ds</a> (char *msg)</td></tr>
<tr class="memdesc:a24adcc1de92743dc8eaeebc54c40b568"><td class="mdescLeft">&#160;</td><td class="mdescRight">Separates the digital signature.  <a href="#a24adcc1de92743dc8eaeebc54c40b568"></a><br/></td></tr>
<tr class="memitem:a0bea39747d167b3417d6e2b427186284"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="general__opts_8h.html#a0bea39747d167b3417d6e2b427186284">authenticate</a> (char *hash1, char *hash2)</td></tr>
<tr class="memdesc:a0bea39747d167b3417d6e2b427186284"><td class="mdescLeft">&#160;</td><td class="mdescRight">Authenticates the hash values are the same or not.  <a href="#a0bea39747d167b3417d6e2b427186284"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>General operations for the program. </p>
<p>General operations used throughout the project, are implemented in this file. </p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a0bea39747d167b3417d6e2b427186284"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="general__opts_8h.html#a0bea39747d167b3417d6e2b427186284">authenticate</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>hash1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>hash2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Authenticates the hash values are the same or not. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">hash1</td><td>Hash value value </td></tr>
    <tr><td class="paramname">hash2</td><td>Other hash value </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>true(1) on success or false(0) on failure</dd></dl>
<p>Compares the hash values and decides if the sent message is not played on its way to the receiver. </p>

</div>
</div>
<a class="anchor" id="a438de4315ebdf2f27597aa7950a70184"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="general__opts_8h.html#a438de4315ebdf2f27597aa7950a70184">concatenate</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>s1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>s2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">s1</td><td>String 1 </td></tr>
    <tr><td class="paramname">s2</td><td>String 2 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>Concatenation of s1 and s2 with separator between.</dd></dl>
<p>This function concatenates 2 strings with a separator in between. The separator is 7 # character. The separator is used for the convenience while extracting the parts. </p>

</div>
</div>
<a class="anchor" id="a992f24eeea692289100bb7cb4c005422"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="general__opts_8h.html#a992f24eeea692289100bb7cb4c005422">create_ds</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_r_s_a___k_e_y.html">rsa_key</a> *&#160;</td>
          <td class="paramname"><em>pr_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Creates the digital signature of the text. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>Plain text </td></tr>
    <tr><td class="paramname">pr_key</td><td>Private Key used for encryption of hash </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>Digital Signature of the given plain text</dd></dl>
<p>Digital signature is the encrypted hash of a given text via the owners/senders private key because the digital signature is unique value to that text. It enables us to be sure about the sent message is valid. </p>

</div>
</div>
<a class="anchor" id="af5291dd029356e9bb2946bd0bfa2d7a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="general__opts_8h.html#af5291dd029356e9bb2946bd0bfa2d7a8">create_hash_of_file</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Hashes the given file. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>Hashed value.</dd></dl>
<p>Creates the hash of the given file using SHA256 (Secure Hash Algorithm 256 Bits) secure hash algorithm. The SHA256's output is a 256bit hexadecimal number. The source code of the used SHA256 can be found in <a class="el" href="sha256_8h.html" title="The SHA implementation with 256 bit hash.">sha256.h</a> file. </p>

</div>
</div>
<a class="anchor" id="a250f51f15a488f405157e57769d8ad0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="general__opts_8h.html#a250f51f15a488f405157e57769d8ad0e">create_hash_of_string</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Hashes the given string value. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">str</td><td>Input string </td></tr>
    <tr><td class="paramname">size</td><td>Size of the string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>Hashed value.</dd></dl>
<p>Creates the hash of the input string using SHA256 (Secure Hash Algorithm 256 Bits) secure hash algorithm. The SHA256's output is a 256bit hexadecimal number. The source code of the used SHA256 can be found in <a class="el" href="sha256_8h.html" title="The SHA implementation with 256 bit hash.">sha256.h</a> file. </p>

</div>
</div>
<a class="anchor" id="a24adcc1de92743dc8eaeebc54c40b568"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="general__opts_8h.html#a24adcc1de92743dc8eaeebc54c40b568">extract_ds</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Separates the digital signature. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Decrypted Message sent to the receiver </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>The digital signature created by the sender</dd></dl>
<p>Separates the digital signature from the concatenation of plain text and digital signature. This operation is done after the decryption of the received file. </p>

</div>
</div>
<a class="anchor" id="aac69d038742dcc1a00a1311a9421b63d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="general__opts_8h.html#aac69d038742dcc1a00a1311a9421b63d">extract_id</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Separates the plain text. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Decrypted message sent to the receiver </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>The plain text.</dd></dl>
<p>Separates the plain text from the concatenation of plain text and digital signature. This operation is done after the decryption of the received file. </p>

</div>
</div>
<a class="anchor" id="a7b5bcb0d1c99ef714c433413a254617f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_r_s_a___k_e_y.html">rsa_key</a>* <a class="el" href="general__opts_8h.html#a7b5bcb0d1c99ef714c433413a254617f">get_key_from_file</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read the RSA key from file. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>Key file's name </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>RSA Key</dd></dl>
<p>GMP (GNU Mathematical Precision Library) is used in this project to be able to work with very long integers. Mostly the long integers were the keys and encrypted texts. Since we do our exponentiation with GMP numbers, the key file is read with GMP Library functions for easy manipulation on the number. A key file has 2 components separated via new line. first part is the e or d and the second part is n. Our rsa_key structure has k and n elements to hold these values. </p>

</div>
</div>
<a class="anchor" id="a9203fddda70b31c6da977a33328941d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="general__opts_8h.html#a9203fddda70b31c6da977a33328941d1">pri_dec</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_r_s_a___k_e_y.html">rsa_key</a> *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Decrypts the given ciphered text(encrypted with public encryption) with the given private key. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>Ciphered Text </td></tr>
    <tr><td class="paramname">key</td><td>Private Key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>The decrypted text</dd></dl>
<p>This function basically does the RSA decryption. Decompression is done to reveal the 4 characters we compressed after decryption.</p>
<p>M = C^d mod n </p>
<p>will count the total number of decrypted texts</p>
<p>initialized to 0 because first substring of c will start from the</p>
<p>if ciphered text is empty exit</p>
<p>each block contains 4 characters that is compressed into an integer</p>
<p>initialize the gmp numbers</p>
<p>return string</p>
<p>find how many integers/ciphered blocks are there in the ciphered file</p>
<p>allocate the return value, we know the total number of ciphered blocks of characters</p>
<p>each number in the ciphered text(seperated via newline) is read and have turned into mpz_t and decrypted then added to the return string</p>
<p>after we read a new line we will turn thar number into mpz_t and decrypt it.</p>
<p>read the ciphered number into c_val</p>
<p>decrypt the read number;</p>
<p>change gmp_integer to an integer</p>
<p>decompress the int to 4 chars.</p>
<p>add the deciphered block to return string</p>
<p>the next starting index of next sscanf on c. current index points to "\n" but next index points to the starting of a new ciphered block </p>

</div>
</div>
<a class="anchor" id="a360ad629958e9cc22babf446ed6550f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="general__opts_8h.html#a360ad629958e9cc22babf446ed6550f3">pri_enc</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_r_s_a___k_e_y.html">rsa_key</a> *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Encrypts the given plain text with the given private key. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>Plain Text </td></tr>
    <tr><td class="paramname">key</td><td>Private key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>The encrypted text</dd></dl>
<p>Since the RSA encryption used in this project is one type, basically the other encryption function is called. It decrypts the encrypted text with public key.</p>
<p>C = M^e mod n </p>

</div>
</div>
<a class="anchor" id="a5736affaf8dc8bc05558cee3f198f62e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="general__opts_8h.html#a5736affaf8dc8bc05558cee3f198f62e">pub_dec</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_r_s_a___k_e_y.html">rsa_key</a> *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Decrypts the given ciphered text(encrypted with private encryption) with the given public key. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>Ciphered Text </td></tr>
    <tr><td class="paramname">key</td><td>Public Key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>The decrypted text</dd></dl>
<p>The function does the general decryption with public key. It resolves the encryption with private key.</p>
<p>M = C^d mod n </p>

</div>
</div>
<a class="anchor" id="ac2a35e39b455ce1139aa1c8684301da1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="general__opts_8h.html#ac2a35e39b455ce1139aa1c8684301da1">pub_enc</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_r_s_a___k_e_y.html">rsa_key</a> *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Encrypts the given plain text with the given public key. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>Plain Text </td></tr>
    <tr><td class="paramname">key</td><td>Public key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>The encrypted text</dd></dl>
<p>This function basically does the RSA encryption. The method used to represent characters as numbers is compression. Every 4 character block is put into an integer and this integer value is encrypted. Encryption is done via exponentiation.</p>
<p>C = M^e mod n </p>
<p>will contain the compressed value of characters</p>
<p>size of the plain text</p>
<p>cycle_number is the number which determines how many compressions will be made and as a result the encrypted portions number.</p>
<p>key_length determines the max length of the encrypted value</p>
<p>temporary values will be used in encryption</p>
<p>there will be cycle_number encrypted value as a result,which can be at most at the length of n, since they are taken mod of n so we allocate memory according to that values. In addition there will be separators '<br/>
' at the end of each encrypted value.</p>
<p>initialize the string to termination character</p>
<p>compress 4 chars to an int compressed</p>
<p>exponentiation</p>
<p>add the exponentiated value to the string </p>

</div>
</div>
<a class="anchor" id="a20100a033cb2270b7e73bc8411fb5421"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="general__opts_8h.html#a20100a033cb2270b7e73bc8411fb5421">read_file_to_string</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gets file content. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>File </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>File content</dd></dl>
<p>File contents is read and put into a character array. In the end the character array is returned to user. </p>

</div>
</div>
<a class="anchor" id="a118bb481605bbf6a2ad228f078369999"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="general__opts_8h.html#a118bb481605bbf6a2ad228f078369999">write_private_key_to_file</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_r_s_a___k_e_y_s.html">rsa_keys</a> *&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>username</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Writes the private key to file with user name. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">keys</td><td></td></tr>
    <tr><td class="paramname">username</td><td>Since our keys are user based, each person has a key pair, we need to discrete them in a way. So in this project user names are requested while a pair of RSA key is being created. This way there will be no mix ups in the keys. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2f2b3dc8a17b5aacaef9690409de89df"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="general__opts_8h.html#a2f2b3dc8a17b5aacaef9690409de89df">write_public_key_to_file</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_r_s_a___k_e_y_s.html">rsa_keys</a> *&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>username</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Writes the public key to file with user name. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">keys</td><td></td></tr>
    <tr><td class="paramname">username</td><td>Since our keys are user based, each person has a key pair, we need to discrete them in a way. So in this project user names are requested while a pair of RSA key is being created. This way there will be no mix ups in the keys. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab2b15940f94a5725da201f7ccfc1f742"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="general__opts_8h.html#ab2b15940f94a5725da201f7ccfc1f742">write_string_to_file</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Writes the string to file. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>File </td></tr>
    <tr><td class="paramname">str</td><td>The string to be written to the file</td></tr>
  </table>
  </dd>
</dl>
<p>Writes the given string to a file with the desired file name. </p>

</div>
</div>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 23 2012 10:04:02 for RSA Message Encryption and Authentication with X-509 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.0
</small></address>

</body>
</html>
